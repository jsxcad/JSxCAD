import { canonicalize } from "@jsxcad/geometry-paths";
import { fromRaster } from "./fromRaster";
import test from "ava";

test("Simple", async (t) => {
  const raster = [
    [13, 34, 53, 75],
    [34, 46, 61, 79],
    [59, 64, 71, 86],
    [77, 81, 86, 99],
  ];
  const result = await fromRaster(raster, [0, 25, 50, 75, 100]);
  t.deepEqual(result.map(canonicalize), [
    [
      [
        [0, 0.57143, 0],
        [0, 0, 0],
        [0.57143, 0, 0],
      ],
    ],
    [
      [
        [0.57143, 0, 25],
        [1, 0, 25],
        [2, 0, 25],
        [3, 0, 25],
        [2.77778, 1, 25],
        [2.26667, 2, 25],
        [2, 2.26667, 25],
        [1, 2.64706, 25],
        [0, 2.88889, 25],
        [0, 2, 25],
        [0, 1, 25],
        [0, 0.57143, 25],
      ],
    ],
    [
      [
        [1, 1.22222, 50],
        [1.26667, 1, 50],
        [1.84211, 0, 50],
        [2, 0, 50],
        [3, 0, 50],
        [3, 1, 50],
        [3, 2, 50],
        [3, 3, 50],
        [2, 3, 50],
        [1, 3, 50],
        [0, 3, 50],
        [0, 2, 50],
        [0, 1.64, 50],
      ],
    ],
    [
      [
        [1, 2.64706, 75],
        [2, 2.26667, 75],
        [2.26667, 2, 75],
        [2.77778, 1, 75],
        [3, 0, 75],
        [3, 1, 75],
        [3, 2, 75],
        [3, 3, 75],
        [2, 3, 75],
        [1, 3, 75],
        [0, 3, 75],
        [0, 2.88889, 75],
      ],
    ],
  ]);
});
