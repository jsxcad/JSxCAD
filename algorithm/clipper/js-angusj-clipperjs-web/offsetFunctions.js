"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
Object.defineProperty(exports, "__esModule", { value: true });
var ClipperError_1 = require("./ClipperError");
var ClipperOffset_1 = require("./ClipperOffset");
var addPathOrPaths = function (offset, inputDatas) {
    if (inputDatas === undefined) {
        return;
    }
    // add each input
    for (var i = 0, maxi = inputDatas.length; i < maxi; i++) {
        var inputData = inputDatas[i];
        // add the path/paths
        var pathOrPaths = inputData.data;
        if (!pathOrPaths || pathOrPaths.length <= 0) {
            continue;
        }
        // is it a path or paths?
        if (Array.isArray(pathOrPaths[0])) {
            // paths
            offset.addPaths(pathOrPaths, inputData.joinType, inputData.endType);
        }
        else {
            // path
            offset.addPath(pathOrPaths, inputData.joinType, inputData.endType);
        }
    }
};
function offsetToPathsOrPolyTree(polyTreeMode, nativeClipperLib, params) {
    var filledData = __assign({ arcTolerance: 0.25, miterLimit: 2 }, params);
    var offset = new ClipperOffset_1.ClipperOffset(nativeClipperLib, filledData.miterLimit, filledData.arcTolerance);
    //noinspection UnusedCatchParameterJS
    try {
        addPathOrPaths(offset, params.offsetInputs);
        if (!polyTreeMode) {
            return offset.executeToPaths(params.delta, params.cleanDistance);
        }
        else {
            if (params.cleanDistance !== undefined) {
                throw new ClipperError_1.ClipperError("cleaning is not available for poly tree results");
            }
            return offset.executeToPolyTree(params.delta);
        }
    }
    catch (err) {
        return undefined;
    }
    finally {
        offset.dispose();
    }
}
function offsetToPaths(nativeClipperLib, params) {
    return offsetToPathsOrPolyTree(false, nativeClipperLib, params);
}
exports.offsetToPaths = offsetToPaths;
function offsetToPolyTree(nativeClipperLib, params) {
    return offsetToPathsOrPolyTree(true, nativeClipperLib, params);
}
exports.offsetToPolyTree = offsetToPolyTree;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2Zmc2V0RnVuY3Rpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL29mZnNldEZ1bmN0aW9ucy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEsK0NBQThDO0FBQzlDLGlEQUFnRDtBQTBGaEQsSUFBTSxjQUFjLEdBQUcsVUFBQyxNQUFxQixFQUFFLFVBQXFDO0lBQ2xGLElBQUksVUFBVSxLQUFLLFNBQVMsRUFBRTtRQUM1QixPQUFPO0tBQ1I7SUFFRCxpQkFBaUI7SUFDakIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsSUFBSSxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUN2RCxJQUFNLFNBQVMsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFaEMscUJBQXFCO1FBQ3JCLElBQU0sV0FBVyxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUM7UUFDbkMsSUFBSSxDQUFDLFdBQVcsSUFBSSxXQUFXLENBQUMsTUFBTSxJQUFJLENBQUMsRUFBRTtZQUMzQyxTQUFTO1NBQ1Y7UUFFRCx5QkFBeUI7UUFDekIsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ2pDLFFBQVE7WUFDUixNQUFNLENBQUMsUUFBUSxDQUFDLFdBQTRCLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDdEY7YUFBTTtZQUNMLE9BQU87WUFDUCxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQTJCLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDcEY7S0FDRjtBQUNILENBQUMsQ0FBQztBQUVGLFNBQVMsdUJBQXVCLENBQzlCLFlBQXFCLEVBQ3JCLGdCQUEwQyxFQUMxQyxNQUFvQjtJQUVwQixJQUFNLFVBQVUsY0FDZCxZQUFZLEVBQUUsSUFBSSxFQUNsQixVQUFVLEVBQUUsQ0FBQyxJQUNWLE1BQU0sQ0FDVixDQUFDO0lBRUYsSUFBTSxNQUFNLEdBQUcsSUFBSSw2QkFBYSxDQUM5QixnQkFBZ0IsRUFDaEIsVUFBVSxDQUFDLFVBQVUsRUFDckIsVUFBVSxDQUFDLFlBQVksQ0FDeEIsQ0FBQztJQUVGLHFDQUFxQztJQUNyQyxJQUFJO1FBQ0YsY0FBYyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDNUMsSUFBSSxDQUFDLFlBQVksRUFBRTtZQUNqQixPQUFPLE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7U0FDbEU7YUFBTTtZQUNMLElBQUksTUFBTSxDQUFDLGFBQWEsS0FBSyxTQUFTLEVBQUU7Z0JBQ3RDLE1BQU0sSUFBSSwyQkFBWSxDQUFDLGlEQUFpRCxDQUFDLENBQUM7YUFDM0U7WUFDRCxPQUFPLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDL0M7S0FDRjtJQUFDLE9BQU8sR0FBRyxFQUFFO1FBQ1osT0FBTyxTQUFTLENBQUM7S0FDbEI7WUFBUztRQUNSLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQztLQUNsQjtBQUNILENBQUM7QUFFRCxTQUFnQixhQUFhLENBQzNCLGdCQUEwQyxFQUMxQyxNQUFvQjtJQUVwQixPQUFPLHVCQUF1QixDQUFDLEtBQUssRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLENBQXNCLENBQUM7QUFDdkYsQ0FBQztBQUxELHNDQUtDO0FBRUQsU0FBZ0IsZ0JBQWdCLENBQzlCLGdCQUEwQyxFQUMxQyxNQUFvQjtJQUVwQixPQUFPLHVCQUF1QixDQUFDLElBQUksRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLENBQXlCLENBQUM7QUFDekYsQ0FBQztBQUxELDRDQUtDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2xpcHBlckVycm9yIH0gZnJvbSBcIi4vQ2xpcHBlckVycm9yXCI7XHJcbmltcG9ydCB7IENsaXBwZXJPZmZzZXQgfSBmcm9tIFwiLi9DbGlwcGVyT2Zmc2V0XCI7XHJcbmltcG9ydCB7IEVuZFR5cGUsIEpvaW5UeXBlIH0gZnJvbSBcIi4vZW51bXNcIjtcclxuaW1wb3J0IHsgTmF0aXZlQ2xpcHBlckxpYkluc3RhbmNlIH0gZnJvbSBcIi4vbmF0aXZlL05hdGl2ZUNsaXBwZXJMaWJJbnN0YW5jZVwiO1xyXG5pbXBvcnQgeyBQYXRoLCBSZWFkb25seVBhdGggfSBmcm9tIFwiLi9QYXRoXCI7XHJcbmltcG9ydCB7IFBhdGhzLCBSZWFkb25seVBhdGhzIH0gZnJvbSBcIi4vUGF0aHNcIjtcclxuaW1wb3J0IHsgUG9seVRyZWUgfSBmcm9tIFwiLi9Qb2x5VHJlZVwiO1xyXG5cclxuLyoqXHJcbiAqIEEgc2luZ2xlIGlucHV0IChvZiBtdWx0aXBsZSBwb3NzaWJsZSBpbnB1dHMpIGZvciB0aGUgb2Zmc2V0VG9QYXRocyAvIG9mZnNldFRvUG9seVRyZWUgb3BlcmF0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBPZmZzZXRJbnB1dCB7XHJcbiAgLyoqXHJcbiAgICogSm9pbiB0eXBlLlxyXG4gICAqL1xyXG4gIGpvaW5UeXBlOiBKb2luVHlwZTtcclxuXHJcbiAgLyoqXHJcbiAgICogRW5kIHR5cGUuXHJcbiAgICovXHJcbiAgZW5kVHlwZTogRW5kVHlwZTtcclxuXHJcbiAgLyoqXHJcbiAgICogRGF0YSBvZiBvbmUgb2YgdGhlIFBhdGggb3IgUGF0aHMgdG8gYmUgdXNlZCBpbiBwcmVwYXJhdGlvbiBmb3Igb2Zmc2V0dGluZy5cclxuICAgKlxyXG4gICAqIEFsbCAnb3V0ZXInIFBhdGhzIG11c3QgaGF2ZSB0aGUgc2FtZSBvcmllbnRhdGlvbiwgYW5kIGFueSAnaG9sZScgcGF0aHMgbXVzdCBoYXZlIHJldmVyc2Ugb3JpZW50YXRpb24uIENsb3NlZCBwYXRocyBtdXN0IGhhdmUgYXQgbGVhc3QgMyB2ZXJ0aWNlcy5cclxuICAgKiBPcGVuIHBhdGhzIG1heSBoYXZlIGFzIGZldyBhcyBvbmUgdmVydGV4LiBPcGVuIHBhdGhzIGNhbiBvbmx5IGJlIG9mZnNldCB3aXRoIHBvc2l0aXZlIGRlbHRhcy5cclxuICAgKi9cclxuICBkYXRhOiBSZWFkb25seVBhdGggfCBSZWFkb25seVBhdGhzO1xyXG59XHJcblxyXG4vKipcclxuICogUGFyYW1zIGZvciB0aGUgcG9seWdvbiBvZmZzZXQgb3BlcmF0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBPZmZzZXRQYXJhbXMge1xyXG4gIC8qKlxyXG4gICAqIEZpcnN0bHksIHRoaXMgZmllbGQvcHJvcGVydHkgaXMgb25seSByZWxldmFudCB3aGVuIEpvaW5UeXBlID0gUm91bmQgYW5kL29yIEVuZFR5cGUgPSBSb3VuZC5cclxuICAgKlxyXG4gICAqIFNpbmNlIGZsYXR0ZW5lZCBwYXRocyBjYW4gbmV2ZXIgcGVyZmVjdGx5IHJlcHJlc2VudCBhcmNzLCB0aGlzIGZpZWxkL3Byb3BlcnR5IHNwZWNpZmllcyBhIG1heGltdW0gYWNjZXB0YWJsZSBpbXByZWNpc2lvbiAoJ3RvbGVyYW5jZScpIHdoZW4gYXJjcyBhcmVcclxuICAgKiBhcHByb3hpbWF0ZWQgaW4gYW4gb2Zmc2V0dGluZyBvcGVyYXRpb24uIFNtYWxsZXIgdmFsdWVzIHdpbGwgaW5jcmVhc2UgJ3Ntb290aG5lc3MnIHVwIHRvIGEgcG9pbnQgdGhvdWdoIGF0IGEgY29zdCBvZiBwZXJmb3JtYW5jZSBhbmQgaW4gY3JlYXRpbmcgbW9yZVxyXG4gICAqIHZlcnRpY2VzIHRvIGNvbnN0cnVjdCB0aGUgYXJjLlxyXG4gICAqXHJcbiAgICogVGhlIGRlZmF1bHQgQXJjVG9sZXJhbmNlIGlzIDAuMjUgdW5pdHMuIFRoaXMgbWVhbnMgdGhhdCB0aGUgbWF4aW11bSBkaXN0YW5jZSB0aGUgZmxhdHRlbmVkIHBhdGggd2lsbCBkZXZpYXRlIGZyb20gdGhlICd0cnVlJyBhcmMgd2lsbCBiZSBubyBtb3JlXHJcbiAgICogdGhhbiAwLjI1IHVuaXRzIChiZWZvcmUgcm91bmRpbmcpLlxyXG4gICAqXHJcbiAgICogUmVkdWNpbmcgdG9sZXJhbmNlcyBiZWxvdyAwLjI1IHdpbGwgbm90IGltcHJvdmUgc21vb3RobmVzcyBzaW5jZSB2ZXJ0ZXggY29vcmRpbmF0ZXMgd2lsbCBzdGlsbCBiZSByb3VuZGVkIHRvIGludGVnZXIgdmFsdWVzLiBUaGUgb25seSB3YXkgdG8gYWNoaWV2ZVxyXG4gICAqIHN1Yi1pbnRlZ2VyIHByZWNpc2lvbiBpcyB0aHJvdWdoIGNvb3JkaW5hdGUgc2NhbGluZyBiZWZvcmUgYW5kIGFmdGVyIG9mZnNldHRpbmcgKHNlZSBleGFtcGxlIGJlbG93KS5cclxuICAgKlxyXG4gICAqIEl0J3MgaW1wb3J0YW50IHRvIG1ha2UgQXJjVG9sZXJhbmNlIGEgc2Vuc2libGUgZnJhY3Rpb24gb2YgdGhlIG9mZnNldCBkZWx0YSAoYXJjIHJhZGl1cykuIExhcmdlIHRvbGVyYW5jZXMgcmVsYXRpdmUgdG8gdGhlIG9mZnNldCBkZWx0YSB3aWxsIHByb2R1Y2VcclxuICAgKiBwb29yIGFyYyBhcHByb3hpbWF0aW9ucyBidXQsIGp1c3QgYXMgaW1wb3J0YW50bHksIHZlcnkgc21hbGwgdG9sZXJhbmNlcyB3aWxsIHN1YnN0YW50aWFsbHkgc2xvdyBvZmZzZXR0aW5nIHBlcmZvcm1hbmNlIHdoaWxlIHByb3ZpZGluZyB1bm5lY2Vzc2FyeVxyXG4gICAqIGRlZ3JlZXMgb2YgcHJlY2lzaW9uLiBUaGlzIGlzIG1vc3QgbGlrZWx5IHRvIGJlIGFuIGlzc3VlIHdoZW4gb2Zmc2V0dGluZyBwb2x5Z29ucyB3aG9zZSBjb29yZGluYXRlcyBoYXZlIGJlZW4gc2NhbGVkIHRvIHByZXNlcnZlIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbi5cclxuICAgKlxyXG4gICAqIEV4YW1wbGU6IEltYWdpbmUgYSBzZXQgb2YgcG9seWdvbnMgKGRlZmluZWQgaW4gZmxvYXRpbmcgcG9pbnQgY29vcmRpbmF0ZXMpIHRoYXQgaXMgdG8gYmUgb2Zmc2V0IGJ5IDEwIHVuaXRzIHVzaW5nIHJvdW5kIGpvaW5zLCBhbmQgdGhlIHNvbHV0aW9uIGlzIHRvXHJcbiAgICogcmV0YWluIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbiB1cCB0byBhdCBsZWFzdCA2IGRlY2ltYWwgcGxhY2VzLlxyXG4gICAqIFRvIHByZXNlcnZlIHRoaXMgZGVncmVlIG9mIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbiwgYW5kIGdpdmVuIHRoYXQgQ2xpcHBlciBhbmQgQ2xpcHBlck9mZnNldCBib3RoIG9wZXJhdGUgb24gaW50ZWdlciBjb29yZGluYXRlcywgdGhlIHBvbHlnb25cclxuICAgKiBjb29yZGluYXRlcyB3aWxsIGJlIHNjYWxlZCB1cCBieSAxMDggKGFuZCByb3VuZGVkIHRvIGludGVnZXJzKSBwcmlvciB0byBvZmZzZXR0aW5nLiBCb3RoIG9mZnNldCBkZWx0YSBhbmQgQXJjVG9sZXJhbmNlIHdpbGwgYWxzbyBuZWVkIHRvIGJlIHNjYWxlZFxyXG4gICAqIGJ5IHRoaXMgc2FtZSBmYWN0b3IuIElmIEFyY1RvbGVyYW5jZSB3YXMgbGVmdCB1bnNjYWxlZCBhdCB0aGUgZGVmYXVsdCAwLjI1IHVuaXRzLCBldmVyeSBhcmMgaW4gdGhlIHNvbHV0aW9uIHdvdWxkIGNvbnRhaW4gYSBmcmFjdGlvbiBvZiA0NCBUSE9VU0FORFxyXG4gICAqIHZlcnRpY2VzIHdoaWxlIHRoZSBmaW5hbCBhcmMgaW1wcmVjaXNpb24gd291bGQgYmUgMC4yNSDDlyAxMC04IHVuaXRzIChpZSBvbmNlIHNjYWxpbmcgd2FzIHJldmVyc2VkKS4gSG93ZXZlciwgaWYgMC4xIHVuaXRzIHdhcyBhbiBhY2NlcHRhYmxlIGltcHJlY2lzaW9uXHJcbiAgICogaW4gdGhlIGZpbmFsIHVuc2NhbGVkIHNvbHV0aW9uLCB0aGVuIEFyY1RvbGVyYW5jZSBzaG91bGQgYmUgc2V0IHRvIDAuMSDDlyBzY2FsaW5nX2ZhY3RvciAoMC4xIMOXIDEwOCApLiBOb3cgaWYgc2NhbGluZyBpcyBhcHBsaWVkIGVxdWFsbHkgdG8gYm90aFxyXG4gICAqIEFyY1RvbGVyYW5jZSBhbmQgdG8gRGVsdGEgT2Zmc2V0LCB0aGVuIGluIHRoaXMgZXhhbXBsZSB0aGUgbnVtYmVyIG9mIHZlcnRpY2VzIChzdGVwcykgZGVmaW5pbmcgZWFjaCBhcmMgd291bGQgYmUgYSBmcmFjdGlvbiBvZiAyMy5cclxuICAgKlxyXG4gICAqIFRoZSBmb3JtdWxhIGZvciB0aGUgbnVtYmVyIG9mIHN0ZXBzIGluIGEgZnVsbCBjaXJjdWxhciBhcmMgaXMgLi4uIFBpIC8gYWNvcygxIC0gYXJjX3RvbGVyYW5jZSAvIGFicyhkZWx0YSkpXHJcbiAgICovXHJcbiAgYXJjVG9sZXJhbmNlPzogbnVtYmVyOyAvLyBkZWZhdWx0cyB0byAwLjI1XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgcHJvcGVydHkgc2V0cyB0aGUgbWF4aW11bSBkaXN0YW5jZSBpbiBtdWx0aXBsZXMgb2YgZGVsdGEgdGhhdCB2ZXJ0aWNlcyBjYW4gYmUgb2Zmc2V0IGZyb20gdGhlaXIgb3JpZ2luYWwgcG9zaXRpb25zIGJlZm9yZSBzcXVhcmluZyBpcyBhcHBsaWVkLlxyXG4gICAqIChTcXVhcmluZyB0cnVuY2F0ZXMgYSBtaXRlciBieSAnY3V0dGluZyBpdCBvZmYnIGF0IDEgw5cgZGVsdGEgZGlzdGFuY2UgZnJvbSB0aGUgb3JpZ2luYWwgdmVydGV4LilcclxuICAgKlxyXG4gICAqIFRoZSBkZWZhdWx0IHZhbHVlIGZvciBNaXRlckxpbWl0IGlzIDIgKGllIHR3aWNlIGRlbHRhKS4gVGhpcyBpcyBhbHNvIHRoZSBzbWFsbGVzdCBNaXRlckxpbWl0IHRoYXQncyBhbGxvd2VkLiBJZiBtaXRlcmluZyB3YXMgdW5yZXN0cmljdGVkIChpZSB3aXRob3V0XHJcbiAgICogYW55IHNxdWFyaW5nKSwgdGhlbiBvZmZzZXRzIGF0IHZlcnkgYWN1dGUgYW5nbGVzIHdvdWxkIGdlbmVyYXRlIHVuYWNjZXB0YWJseSBsb25nICdzcGlrZXMnLlxyXG4gICAqL1xyXG4gIG1pdGVyTGltaXQ/OiBudW1iZXI7IC8vIGRlZmF1bHRzIHRvIDIgKHR3aWNlIGRlbHRhKVxyXG5cclxuICAvKipcclxuICAgKiBOZWdhdGl2ZSBkZWx0YSB2YWx1ZXMgc2hyaW5rIHBvbHlnb25zIGFuZCBwb3NpdGl2ZSBkZWx0YSBleHBhbmQgdGhlbS5cclxuICAgKi9cclxuICBkZWx0YTogbnVtYmVyO1xyXG5cclxuICAvKipcclxuICAgKiBPbmUgb3IgbW9yZSBpbnB1dHMgdG8gdXNlIGZvciB0aGUgb2Zmc2V0IG9wZXJhdGlvbi5cclxuICAgKi9cclxuICBvZmZzZXRJbnB1dHM6IE9mZnNldElucHV0W107XHJcblxyXG4gIC8qKlxyXG4gICAqIElmIHRoaXMgaXMgbm90IHVuZGVmaW5lZCB0aGVuIGNsZWFuaW5nIG9mIHRoZSByZXN1bHQgcG9seWdvbiB3aWxsIGJlIHBlcmZvcm1lZC5cclxuICAgKiBUaGlzIG9wZXJhdGlvbiBpcyBvbmx5IGF2YWlsYWJsZSB3aGVuIHRoZSBvdXRwdXQgZm9ybWF0IGlzIG5vdCBhIHBvbHkgdHJlZS5cclxuICAgKi9cclxuICBjbGVhbkRpc3RhbmNlPzogbnVtYmVyO1xyXG59XHJcblxyXG5jb25zdCBhZGRQYXRoT3JQYXRocyA9IChvZmZzZXQ6IENsaXBwZXJPZmZzZXQsIGlucHV0RGF0YXM6IE9mZnNldElucHV0W10gfCB1bmRlZmluZWQpID0+IHtcclxuICBpZiAoaW5wdXREYXRhcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICAvLyBhZGQgZWFjaCBpbnB1dFxyXG4gIGZvciAobGV0IGkgPSAwLCBtYXhpID0gaW5wdXREYXRhcy5sZW5ndGg7IGkgPCBtYXhpOyBpKyspIHtcclxuICAgIGNvbnN0IGlucHV0RGF0YSA9IGlucHV0RGF0YXNbaV07XHJcblxyXG4gICAgLy8gYWRkIHRoZSBwYXRoL3BhdGhzXHJcbiAgICBjb25zdCBwYXRoT3JQYXRocyA9IGlucHV0RGF0YS5kYXRhO1xyXG4gICAgaWYgKCFwYXRoT3JQYXRocyB8fCBwYXRoT3JQYXRocy5sZW5ndGggPD0gMCkge1xyXG4gICAgICBjb250aW51ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBpcyBpdCBhIHBhdGggb3IgcGF0aHM/XHJcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwYXRoT3JQYXRoc1swXSkpIHtcclxuICAgICAgLy8gcGF0aHNcclxuICAgICAgb2Zmc2V0LmFkZFBhdGhzKHBhdGhPclBhdGhzIGFzIFJlYWRvbmx5UGF0aHMsIGlucHV0RGF0YS5qb2luVHlwZSwgaW5wdXREYXRhLmVuZFR5cGUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gcGF0aFxyXG4gICAgICBvZmZzZXQuYWRkUGF0aChwYXRoT3JQYXRocyBhcyBSZWFkb25seVBhdGgsIGlucHV0RGF0YS5qb2luVHlwZSwgaW5wdXREYXRhLmVuZFR5cGUpO1xyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbmZ1bmN0aW9uIG9mZnNldFRvUGF0aHNPclBvbHlUcmVlKFxyXG4gIHBvbHlUcmVlTW9kZTogYm9vbGVhbixcclxuICBuYXRpdmVDbGlwcGVyTGliOiBOYXRpdmVDbGlwcGVyTGliSW5zdGFuY2UsXHJcbiAgcGFyYW1zOiBPZmZzZXRQYXJhbXNcclxuKTogUGF0aHMgfCBQb2x5VHJlZSB8IHVuZGVmaW5lZCB7XHJcbiAgY29uc3QgZmlsbGVkRGF0YSA9IHtcclxuICAgIGFyY1RvbGVyYW5jZTogMC4yNSxcclxuICAgIG1pdGVyTGltaXQ6IDIsXHJcbiAgICAuLi5wYXJhbXNcclxuICB9O1xyXG5cclxuICBjb25zdCBvZmZzZXQgPSBuZXcgQ2xpcHBlck9mZnNldChcclxuICAgIG5hdGl2ZUNsaXBwZXJMaWIsXHJcbiAgICBmaWxsZWREYXRhLm1pdGVyTGltaXQsXHJcbiAgICBmaWxsZWREYXRhLmFyY1RvbGVyYW5jZVxyXG4gICk7XHJcblxyXG4gIC8vbm9pbnNwZWN0aW9uIFVudXNlZENhdGNoUGFyYW1ldGVySlNcclxuICB0cnkge1xyXG4gICAgYWRkUGF0aE9yUGF0aHMob2Zmc2V0LCBwYXJhbXMub2Zmc2V0SW5wdXRzKTtcclxuICAgIGlmICghcG9seVRyZWVNb2RlKSB7XHJcbiAgICAgIHJldHVybiBvZmZzZXQuZXhlY3V0ZVRvUGF0aHMocGFyYW1zLmRlbHRhLCBwYXJhbXMuY2xlYW5EaXN0YW5jZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAocGFyYW1zLmNsZWFuRGlzdGFuY2UgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBDbGlwcGVyRXJyb3IoXCJjbGVhbmluZyBpcyBub3QgYXZhaWxhYmxlIGZvciBwb2x5IHRyZWUgcmVzdWx0c1wiKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gb2Zmc2V0LmV4ZWN1dGVUb1BvbHlUcmVlKHBhcmFtcy5kZWx0YSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gIH0gZmluYWxseSB7XHJcbiAgICBvZmZzZXQuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9mZnNldFRvUGF0aHMoXHJcbiAgbmF0aXZlQ2xpcHBlckxpYjogTmF0aXZlQ2xpcHBlckxpYkluc3RhbmNlLFxyXG4gIHBhcmFtczogT2Zmc2V0UGFyYW1zXHJcbik6IFBhdGhzIHwgdW5kZWZpbmVkIHtcclxuICByZXR1cm4gb2Zmc2V0VG9QYXRoc09yUG9seVRyZWUoZmFsc2UsIG5hdGl2ZUNsaXBwZXJMaWIsIHBhcmFtcykgYXMgUGF0aHMgfCB1bmRlZmluZWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvZmZzZXRUb1BvbHlUcmVlKFxyXG4gIG5hdGl2ZUNsaXBwZXJMaWI6IE5hdGl2ZUNsaXBwZXJMaWJJbnN0YW5jZSxcclxuICBwYXJhbXM6IE9mZnNldFBhcmFtc1xyXG4pOiBQb2x5VHJlZSB8IHVuZGVmaW5lZCB7XHJcbiAgcmV0dXJuIG9mZnNldFRvUGF0aHNPclBvbHlUcmVlKHRydWUsIG5hdGl2ZUNsaXBwZXJMaWIsIHBhcmFtcykgYXMgUG9seVRyZWUgfCB1bmRlZmluZWQ7XHJcbn1cclxuIl19